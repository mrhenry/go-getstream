box: simonmenke/go-build:latest

build:
  steps:
  - setup-go-workspace

  - script:
      name: go build
      code: |
        go get github.com/pborman/uuid
        go get gopkg.in/dgrijalva/jwt-go.v3
        go get gopkg.in/LeisureLink/httpsig.v1
        CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build
  - script:
      name: go test
      code: |
        go get github.com/pborman/uuid
        go get gopkg.in/dgrijalva/jwt-go.v3
        go get gopkg.in/LeisureLink/httpsig.v1
        go test ./getstream_test -coverprofile=../coverage.txt -covermode=atomic
  - script:
      name: codecov
      code: |
        bash <(curl -s https://codecov.io/bash)
